<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"><title>Staff Dashboard</title><style>body{font-family:'Segoe UI',sans-serif;background-color:#f4f7f6;margin:20px}h1{text-align:center;color:#333}table{width:100%;border-collapse:collapse;margin-top:20px;box-shadow:0 2px 15px rgba(0,0,0,.1);background-color:#fff}th,td{padding:12px 15px;text-align:left;border-bottom:1px solid #ddd}thead{background-color:#007bff;color:#fff}tbody tr:nth-child(even){background-color:#f8f9fa}tbody tr:hover{background-color:#e9ecef}.priority-Critical{background-color:#8B0000!important;color:#fff;font-weight:700}.priority-High{background-color:#dc3545!important;color:#fff}.priority-Medium{background-color:#ffc107;color:#333}</style></head>
<body><h1>Staff Complaint Dashboard</h1><table id="complaints-table"><thead><tr><th>Priority</th><th>Emotion</th><th>Complaint</th><th>Category</th><th>Submitter</th><th>Key Tokens</th></tr></thead><tbody></tbody></table>
<script>
async function fetchComplaints(){try{const t=await fetch("/api/complaints"),e=await t.json(),o=document.querySelector("#complaints-table tbody");o.innerHTML="",e.sort((t,e)=>{const o={Critical:0,High:1,Medium:2,Low:3,"Very Low":4},n=o[t.predicted_priority]??99,a=o[e.predicted_priority]??99;return n-a}),e.forEach(t=>{const e=document.createElement("tr"),n=`priority-${t.predicted_priority.replace(" ","-")}`;e.innerHTML=`
                    <td class="${n}">${t.predicted_priority}</td>
                    <td>${t.detected_emotion}</td>
                    <td>${t.complain_text}</td>
                    <td>${t.category}</td>
                    <td>${t.submitter_name} (Roll: ${t.roll_number||"N/A"})</td>
                    <td>${t.key_tokens}</td>
                `,o.appendChild(e)})}catch(t){console.error("Failed to fetch complaints:",t)}}window.onload=fetchComplaints,setInterval(fetchComplaints,1e4);
</script></body></html>